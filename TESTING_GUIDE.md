# 🧪 微信发布功能测试指南

## 📋 测试概述

我们已经成功将完整的微信文章发布工具推送到仓库，现在需要验证发布功能是否正常工作。

## 🚀 快速测试步骤

### 方法1：使用分步测试工具（推荐）

1. **启动服务**
   ```bash
   # Windows用户
   start-wechat-publisher.bat
   
   # Mac/Linux用户
   ./start-wechat-publisher.sh
   ```

2. **打开测试工具**
   - 访问：`http://localhost:3000/test-wechat-publish.html`
   - 这是专门的测试工具，分步骤验证每个功能

3. **按步骤测试**
   - **步骤1**：输入微信AppID和AppSecret，点击"测试配置"
   - **步骤2**：点击"获取Access Token"
   - **步骤3**：上传一张测试图片（可选）
   - **步骤4**：填写测试标题和内容，点击"创建草稿"
   - **步骤5**：查看测试总结

4. **验证结果**
   - 登录微信公众号后台
   - 查看"草稿箱"
   - 确认测试文章是否成功创建

### 方法2：使用完整工具测试

1. **启动服务**（同上）

2. **打开发布工具**
   - 访问：`http://localhost:3000/wechat-publisher.html`

3. **配置微信账号**
   - 在顶部配置区域输入AppID和AppSecret
   - 点击"保存配置"
   - 点击"测试连接"

4. **创建测试文章**
   - 切换到"手动输入"标签页
   - 填写测试标题：`🧪 测试发布功能 - [当前时间]`
   - 填写测试内容：HTML格式的测试内容
   - 切换到"预览发布"标签页
   - 上传测试图片（可选）
   - 点击"发布到微信草稿箱"

5. **验证发布**
   - 查看浏览器提示信息
   - 登录微信公众号后台
   - 检查草稿箱中是否有新文章

## 🔧 准备测试环境

### 1. 获取微信公众号配置

```bash
# 微信公众平台后台地址
https://mp.weixin.qq.com

# 获取配置路径
开发 → 基本配置 → AppID/AppSecret
设置 → 开发 → IP白名单
```

### 2. 配置IP白名单

如果使用本地测试，需要添加本地IP到白名单：
```bash
# 常用本地IP（根据实际情况选择）
127.0.0.1          # 本地回环
192.168.1.x         # 局域网IP
10.0.0.x           # 局域网IP

# 如果部署到云端，使用服务器公网IP
curl ip.sb           # 获取公网IP
```

### 3. 准备测试素材

- **测试图片**：任意JPG/PNG图片，大小<2MB
- **测试内容**：简单的HTML文本
- **测试标题**：不超过64个字符

## 📊 测试结果检查

### ✅ 成功标志

1. **配置测试成功**
   - 提示："配置保存成功"
   - AppID显示为***后4位

2. **Token获取成功**
   - 提示："Access Token获取成功"
   - 返回access_token字段

3. **图片上传成功**
   - 提示："图片上传成功"
   - 返回图片URL

4. **草稿创建成功**
   - 提示："草稿创建成功"
   - 返回media_id

5. **后台验证成功**
   - 微信公众号后台草稿箱显示新文章
   - 标题和内容正确显示

### ❌ 常见失败情况

| 错误 | 原因 | 解决方案 |
|------|------|----------|
| 配置失败 | AppID/Secret错误 | 检查配置是否正确 |
| Token失败 | IP不在白名单 | 添加服务器IP到白名单 |
| 上传失败 | 图片格式/大小问题 | 使用JPG/PNG，<2MB |
| 草稿失败 | 内容格式错误 | 检查HTML标签是否正确 |

## 🔄 问题排查步骤

### 1. 检查服务状态
```bash
# 确认服务正在运行
curl http://localhost:3000/api/health

# 应该返回：
{
  "status": "ok",
  "timestamp": "...",
  "service": "TrendPublish API",
  "version": "1.0.0"
}
```

### 2. 检查微信配置
```bash
# 测试微信API连通性
curl "https://api.weixin.qq.com/cgi-bin/token?grant_type=client_credential&appid=YOUR_APPID&secret=YOUR_SECRET"
```

### 3. 查看详细日志
- 打开浏览器开发者工具（F12）
- 查看Network标签页的API请求
- 查看Console标签页的错误信息

### 4. 验证IP白名单
```bash
# 获取当前公网IP
curl ip.sb

# 确认该IP在微信公众平台白名单中
```

## 📱 移动端测试

### 浏览器测试
- 使用手机浏览器访问本地服务
- 测试响应式布局
- 验证触屏操作

### 功能测试
- 图片上传（拍照或选择）
- 文本输入和编辑
- 发布操作

## 🎯 测试报告模板

完成测试后，可以使用以下模板记录结果：

```
微信发布功能测试报告
===================

测试时间：______
测试环境：Windows/Mac/Linux + Chrome/Firefox/Safari

测试步骤结果：
□ 配置测试 - 成功/失败 - 备注：______
□ Token获取 - 成功/失败 - 备注：______
□ 图片上传 - 成功/失败 - 备注：______
□ 草稿创建 - 成功/失败 - 备注：______

微信后台验证：
□ 草稿箱显示新文章 - 是/否
□ 标题显示正确 - 是/否
□ 内容显示正确 - 是/否
□ 图片显示正常 - 是/否

问题记录：
1. ____
2. ____

总体评价：
□ 完全正常工作
□ 基本正常，有小问题
□ 存在严重问题

改进建议：
______
```

## 🚨 安全注意事项

### 测试环境安全
- 不要在公共场所使用测试工具
- 测试完成后及时清除配置
- 不要在代码中提交真实的AppSecret

### 微信账号安全
- 使用测试公众号而不是正式公众号
- 定期更换AppSecret
- 监控API调用日志

## 📞 获取技术支持

如果测试过程中遇到问题：

1. **查看文档**
   - `WECHAT_PUBLISHER_GUIDE.md` - 详细使用指南
   - `README_WECHAT_PUBLISHER.md` - 项目总览

2. **检查控制台**
   - 浏览器F12开发者工具
   - 查看Network和Console标签

3. **社区支持**
   - GitHub Issues：报告问题
   - 查看已知问题和解决方案

---

## 🎉 下一步计划

测试通过后，你可以：

1. **正式使用**：发布真实文章到公众号
2. **功能扩展**：添加更多编辑功能
3. **部署上线**：部署到云服务器
4. **团队共享**：让团队成员使用

---

**测试开始时间**：______  
**完成时间**：______  
**测试人员**：______  

🎯 祝你测试顺利！